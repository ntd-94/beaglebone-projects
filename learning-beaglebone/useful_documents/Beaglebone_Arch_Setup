/*-----------Creating SD Card-----------*/

//Zero the beginning of the SD card: 
dd if=/dev/zero of=/dev/sdc bs=1M count=8

//Start fdisk to partition the SD card: 
fdisk /dev/sdc
//At the fdisk prompt, delete old partitions and create a new one:
Type o. This will clear out any partitions on the drive.
Type p to list partitions. There should be no partitions left.
Now type n, then p for primary, 1 for the first partition on the drive, 2048 for the first sector, and then press ENTER to accept the default last sector.
Write the partition table and exit by typing w.

//Make sure partition is unmounted
umount /dev/sdc1

//Create the ext4 filesystem:
mkfs.ext4 -O ^metadata_csum,^64bit /dev/sdc1

//Mount the filesystem: 
mkdir mnt
mount /dev/sdc1 mnt

//Download and extract the root filesystem:
wget http://os.archlinuxarm.org/os/ArchLinuxARM-am33x-latest.tar.gz
bsdtar -xpf ArchLinuxARM-am33x-latest.tar.gz -C mnt && sync

//Install the U-Boot bootloader: 
dd if=mnt/boot/MLO of=/dev/sdc count=1 seek=1 conv=notrunc bs=128k
dd if=mnt/boot/u-boot.img of=/dev/sdc count=2 seek=1 conv=notrunc bs=384k
umount mnt
sync

/*-----------Booting Arch Linux on the Beaglebone-----------*/

//Insert the SD card into the BeagleBone, connect ethernet, and apply 5V power.
//Make sure to hold the boot button near the micro sd slot down while powering the board 
//SSH to the IP address given to the board by your router or use monitor and keyboard
//default password is alarm and root for root account

/*-----------Setting up Arch Linux on the Beaglebone eMMC-----------*/

//After booting into Arch Linux ARM, follow the above steps 1 through 7 using the device /dev/mmcblk1. 

//Steps:
dd if=/dev/zero of=/dev/mmcblk1 bs=1M count=8
fdisk /dev/mmcblk1
umount /dev/mmcblk1p1
mkfs.ext4 -O ^metadata_csum,^64bit /dev/mmcblk1p1
mkdir mnt
mount /dev/mmcblk1p1 mnt
wget http://os.archlinuxarm.org/os/ArchLinuxARM-am33x-latest.tar.gz //Or move over using usb
bsdtar -xpf ArchLinuxARM-am33x-latest.tar.gz -C mnt
sync
dd if=mnt/boot/MLO of=/dev/mmcblk1 count=1 seek=1 conv=notrunc bs=128k
dd if=mnt/boot/u-boot.img of=/dev/mmcblk1 count=2 seek=1 conv=notrunc bs=384k
umount mnt
sync

//Power down the system, waiting until all the LEDs go out:
poweroff
//Remove power, remove the micro SD card, then reapply power.
//The system will boot into eMMC. If an SD card created with the above steps is still in the system when it boots, it will boot to the SD card instead of eMMC.

/*-----------Post-Installation stuff-----------*/

//Change the password for both accounts, while logged onto relevant account type:
passwd

//Set your beaglebone's language and locale, this example will use en_US.UTF-8
vi /etc/locale.gen
locale-gen
echo LANG=en_US.UTF-8 > /etc/locale.conf
export LANG=en_US.UTF-8

//Identify your time zone and set it permanently, I am in  Central Canada
ls /usr/share/zoneinfo/Canada
ln -sf /usr/share/zoneinfo/Canada/Central /etc/localtime
hwclock --systohc --utc

//Change beaglebone hostname
vi /etc/hostname //Change aalrm to your hostname
//Also add your host name to /etc/hosts, add this line
127.0.1.1	Muspell.localdomain	Muspell

//Change alarm user username
usermod -l surt alarm
usermod -d /home/surt -m surt

//Updating and installing software

//Update package database
sudo pacman -Sy
//Upgrade all your packages at once
sudo pacman -Syu
//Bare minimum to allow you to compile code and stuff
pacman -S base-devel
//Install sudo and use visudo to allow users to be part of the wheel group
pacman -S sudo
EDITOR=vi visudo
//uncomment the following line
%wheel ALL=(ALL) ALL
//As root user add your other username to the wheel group
usermod -a -G wheel surt
//Optional stuff I always download
pacman -S bash-completion vim git iw networkmanager

//Setting up wifi
//Follow link below for drivers
http://brilliantlyeasy.com/ubuntu-linux-tl-wn725n-tp-link-version-2-wifi-driver-install/
//Next use networkmanager to connect
systemctl start NetworkManager
systemctl enable NetworkManager //Enables networkmanager on boot
nmcli dev wifi connect OldSchool24 password linkandlock iface wlan0















